
{% extends "./layout/site.html" %}
    {% block content %}
        <title>Public Profile</title>
        
          {% block header_profile %}
            {% include 'user/header_profile.html' %}
          {% endblock %}
            <style>
              div.list_item_container {
                  height: 50px;
                  padding: 2px;
              }
              div.image {
                  width: 90px;
                  height: 50px;
                  float: left;
              }
              div.city {
                  font-style: italic;
                  font-size: 0.8em;
                  color: gray;
              }
            </style>
            <table border="1px solid">
                  
                        <td>
                          <tr>
                             
                              {% if (public_avatar|length > 0) %}
                                
                                      <td>
                                        <img height="100px" width="100px" src="http://localhost/locais_fotos/uploads_users/{{public_avatar.name}}" alt="">
                                      </td>
                                      <td> {{ public_user.name }} </td>
                                 
                                {% else %}
                               
                                      <td><img height="100px" width="100px" src="http://localhost/locais_fotos/uploads_users/default-user-picture.png" alt=""></td>
                                      <td>{{ public_user.name }}</td>
                                
                                {% endif %}
                            
                          </tr>
                            <tr>
                                <td>{{ public_user.name }}</td>
                            </tr>
                            <tr>
                                <td>{{ public_user.city }}</td><td>{{ public_user.uf }}</td>
                            </tr>
                            <tr>
                                <td>descricao :</td>
                            </tr>
                            <tr>
                                <td>{{ public_user.aboutme}}</td>
                            </tr>
                            <tr>
                              <td>{{ public_user.phone}}</td>
                            </tr>
                        </td>
            </table>
        </div>

        <div class="container">
          <table width="100%" border="1">
            <tbody>
              <tr>
                  <td bgcolor="#CCCCCC">
                      <table width="100%" border="0">
                          <tbody>
                            <tr>
                                <td>Locais</td>
                                <td class="direita"><p>&nbsp;</p></td>
                             </tr>
                          </tbody>
                      </table>
                      <table width="100%" border="0" class="centro">
                          <tbody>
                              <tr>
                                  {% if (public_locals|length > 0) %}
                                      {% for key,local in public_locals %}
                                        {% if(local.visibility=='public') %}
                                          <td>
                                              <a href="http://localhost/locais_fotos/local/{{local.id}}">
                                              {% if (public_imagens_locals|length > 0) %}
                                                  {% for arrimg in public_imagens_locals %}
                                                    {% for img in arrimg %}
                                                      {% if (img.locals_id == local.id) %}
                                                        <img width="100" height="77" src="http://localhost/locais_fotos/uploads_locais/{{ img.name }}"/>
                                                      {% endif %}
                                                    {% endfor %}
                                                  {% endfor %}
                                              {% else %}
                                                  <span>Não há fotos cadastradas</span>
                                              {% endif %}
                                                  {{ local.name }}
                                              </a> 
                                          </td>
                                        {% endif %} 
                                      {% endfor %} 
                                  {% else %}
                                      <span>Não há locais cadastrados</span>
                                  {% endif %}
                              </tr>
                          </tbody>
                      </table>
                    </td>
                </tr>
              </tbody>
            </table>
        </div>

        <div class="container">
          <table width="100%" border="1">
            <tbody>
              <tr>
                  <td bgcolor="#CCCCCC">
                      <table width="100%" border="0">
                          <tbody>
                            <tr>
                                <td>Rotas</td>
                                <td class="direita"><p>&nbsp;</p></td>
                             </tr>
                          </tbody>
                      </table>
                      <table width="100%" border="0" class="centro">
                        <!-- ROTAS -->
                        <table width="100%" border="0" class="centro">
                            <tbody>
                                <tr>
                                    {% if (public_routes|length > 0) %}
                                        {% for key,route in public_routes %}
                                          {% if(route.visibility=='public') %}
                                            <td>
                                                <a href="http://localhost/locais_fotos/route/{{route.id}}">
                                                {% if (public_imagens_routes|length > 0) %}
                                                    {% for arrimg in public_imagens_routes %}
                                                      {% for img in arrimg %}
                                                        {% if (img.routes_id == route.id) %}
                                                          <img width="100" height="77" src="http://localhost/locais_fotos/uploads_rotas/{{ img.name }}"/>
                                                        {% endif %}
                                                      {% endfor %}
                                                    {% endfor %}
                                                {% else %}
                                                    <span>Não há fotos cadastradas</span>
                                                {% endif %}
                                                    {{ route.name }}
                                                </a> 
                                            </td> 
                                          {% endif %}
                                        {% endfor %} 
                                    {% else %}
                                        <span>Não há rotas cadastradas</span>
                                    {% endif %}
                                </tr>
                            </tbody>
                        </table>
                        </td>
                    </tr>
                  </tbody>
                </table>
                <form action="" method="">
                  <input id="search_users" type="text" name="term" placeholder="Busca de Usuários" value="" size="60"/>
                </form>
            </div>


              <script type="text/javascript">

                    $.ui.autocomplete.prototype._renderItem = function (ul, item) { 

                      var avatar = item.avatar.name? item.avatar.name : item.avatar;
                      var inner_html = '<a href="http://localhost/locais_fotos/profile/'+item.id+'">';
                      inner_html += '<div class="list_item_container">';
inner_html += '<div class="image">';
inner_html += '<img height="50px" width="50px"';
inner_html += ' src="http://localhost/locais_fotos/uploads_users/' + avatar + '">';
inner_html += '</div>';
                      inner_html += '<div class="label">' + item.name + '</div>';
                      inner_html += '<div class="city">' + item.city + '</div>';
                      inner_html += '</div></a>';
                              return $( "<li></li>" )
                                  .data("item.autocomplete", item)
                                  .append(inner_html)
                                  .appendTo( ul );

                    };

                      $("#search_users").autocomplete({
                        minLength: 0,
                        source: 'http://localhost/locais_fotos/ajax_search_users',
                         focus: function(event, ui) {
                        },
                        select: function(event, ui) {
                        }
                      });
                  
                </script>
    {% endblock %}